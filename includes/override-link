<?php
if (!defined('ABSPATH')) exit;

add_action('wp_footer', function () {
    $url = get_option('rmcl_cart_redirect_url');
    if (!$url) return;
    ?>
    <script>
    const updateMiniCartLink = () => {
        const links = document.querySelectorAll('.wc-block-mini-cart__footer-actions a');
        links.forEach(link => {
            if (link.textContent.includes('Poursuivre mes achats')) {
                link.setAttribute('href', <?php echo json_encode($url); ?>);
            }
        });
    };
    const observer = new MutationObserver(updateMiniCartLink);
    observer.observe(document.body, { childList: true, subtree: true });
    document.addEventListener('DOMContentLoaded', updateMiniCartLink);
    </script>
    <?php
}, 100);

